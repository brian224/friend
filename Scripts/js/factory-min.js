(function(c,a,d,e){var b={Factory:{W:$(c),D:$(a),HB:$("html , body"),H:$("html"),B:$("body"),LContent:$(".l-content"),Device:/Android|webOS|iPad|BlackBerry/i,IOS:/iPhone|iPad|iPod/i,UserAgent:null,Dynamic:null,OS:null,GaLabel:"",GetUserAgent:function(){var f=this;if(f.W.width()<768){f.UserAgent="Mobile"}else{if(f.Device.test(navigator.userAgent)){f.UserAgent="Tablet"}else{f.UserAgent="PC"}}if(navigator.userAgent.indexOf("MSIE 10")>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){f.UserAgent="IE"}else{if(navigator.userAgent.indexOf("MSIE 8")>0||navigator.userAgent.indexOf("MSIE 9")>0){f.UserAgent="IE89"}}f.OS=f.UserAgent!=="PC"?(/iPad|iPhone|iPod/i.test(navigator.userAgent)?"IOS":"Android"):null;f.Dynamic=f.Device.test(navigator.userAgent)?"webkitAnimationEnd webkitTransitionEnd":"animationend transitionend"},Menu:{Click:function(g,f){$(f).parents(".m-nav").toggleClass("is-active")}},PrivateMode:{Init:function(){if(b.Factory.UserAgent!=="IE"&&b.Factory.UserAgent!=="IE89"){if(typeof(FB)==="undefined"){alert("提醒您，您目前正在使用私密瀏覽模式，請關閉此模式，以免導致轉轉賺翻天抽獎無法正常運作，謝謝您的配合。")}try{localStorage.test=2}catch(f){alert("提醒您，您目前正在使用私密瀏覽模式，請關閉此模式，以免導致轉轉賺翻天抽獎無法正常運作，謝謝您的配合。")}}}},Validate:{FormElement:$("form"),PassID:false,PassTel:false,PassEmail:false,Init:function(){var f=this;f.FormElement.find(".input-box").each(function(){$(this).on("focusout",function(){if($(this).parent().hasClass("required")){f.Required($(this))}else{if($(this).parent().hasClass("switch")){f.Switch($(this))}}})})},Click:function(f){var g=this;g.FormElement.find(".input-box").each(function(){if($(this).parent().hasClass("required")){g.Required($(this))}else{if($(this).parent().hasClass("switch")){g.Switch($(this))}}});if(g.PassID===g.PassTel===g.PassEmail===true){c.location.href=$(f).attr("href")}},Required:function(f){var g=this;if($(f).val()===""){$(f).parent().addClass("error").find(".warning").text($(f).parent().data("empty"))}else{$(f).parent().removeClass("error");if($(f).parent().hasClass("cust-id")){if(g.CheckID($(f).val())){$(f).parent().removeClass("error").find(".warning").text("");g.PassID=true}else{$(f).parent().addClass("error").find(".warning").text($(f).parent().data("error"));g.PassID=false}}else{if($(f).parent().hasClass("phone-num")){g.CheckTel($(f),$(f).val())}else{if($(f).parent().hasClass("email")){g.CheckMail($(f),$(f).val())}}}}},Switch:function(f){var h=this,g=$(".switch"),j=g.length,i=0;g.each(function(){if($(this).find(".input-box").val()===""){i+=1}});if(j===i){$(f).parent().addClass("error").find(".warning").text($(f).parent().data("empty"));$(f).parent().siblings(".switch").removeClass("error")}else{if($(f).parent().hasClass("phone-num")){h.CheckTel($(f),$(f).val())}else{if($(f).parent().hasClass("email")){h.CheckMail($(f),$(f).val())}}}},CheckID:function(k){var l="ABCDEFGHJKLMNPQRSTUVXYWZIO";var o=new Array(1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3);var g=new Array(0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5);var n=new Array(9,8,7,6,5,4,3,2,1,1);if(k.length!=10){return false}var j=l.indexOf(k.charAt(0));if(j===-1){return false}var h=o[j]+(g[j]*9);for(var f=1;f<10;f++){var m=parseInt(k.charAt(f));if(isNaN(m)){return false}h=h+(m*n[f])}if(h%10!=0){return false}return true},CheckTel:function(f,g){if(/^09[0-9]{8}$/.test(g)){$(f).parent().removeClass("error").find(".warning").text("");b.Factory.Validate.PassTel=true}else{if($(".email").find("input").val()===""){$(f).parent().addClass("error").find(".warning").text($(f).parent().data("error"));b.Factory.Validate.PassTel=false}else{b.Factory.Validate.PassTel=true}}},CheckMail:function(g,f){var h=f.split("@");if((h.length===1||h[0]===""||h[1]==="")&&($(".phone-num").find("input").val()==="")){$(g).parent().addClass("error").find(".warning").text($(g).parent().data("error"));b.Factory.Validate.PassEmail=false}else{$(g).parent().removeClass("error");b.Factory.Validate.PassEmail=true}}}}};if(!c.Projects){c.Projects=b}else{c.Projects=$.extend({},c.Projects,b)}}(window,document,$));